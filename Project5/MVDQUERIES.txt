/* Made by Hreiðar Ólafur Arnarsson and Maciej Sierzputowski, 2016-11-03 */

SELECT 'Courses: CID-->>TID; CID-->>BID; CID-->>SID' AS MVD, CASE WHEN COUNT(*) = 0 THEN 'Gildir' ELSE 'Gildir ekki' END AS VALIDITY
FROM(
 SELECT CID
  FROM Courses
 GROUP BY CID
 HAVING COUNT(*) > 1 AND COUNT(*) <> COUNT(DISTINCT TID) * COUNT(DISTINCT BID) * COUNT(DISTINCT SID)
) Y;
SELECT 'Courses: TID-->>CID; TID-->>BID; TID-->>SID' AS MVD, CASE WHEN COUNT(*) = 0 THEN 'Gildir' ELSE 'Gildir ekki' END AS VALIDITY
FROM(
 SELECT TID
  FROM Courses
 GROUP BY TID
 HAVING COUNT(*) > 1 AND COUNT(*) <> COUNT(DISTINCT CID) * COUNT(DISTINCT BID) * COUNT(DISTINCT SID)
) Y;
SELECT 'Courses: BID-->>CID; BID-->>TID; BID-->>SID' AS MVD, CASE WHEN COUNT(*) = 0 THEN 'Gildir' ELSE 'Gildir ekki' END AS VALIDITY
FROM(
 SELECT BID
  FROM Courses
 GROUP BY BID
 HAVING COUNT(*) > 1 AND COUNT(*) <> COUNT(DISTINCT CID) * COUNT(DISTINCT TID) * COUNT(DISTINCT SID)
) Y;
SELECT 'Courses: SID-->>CID; SID-->>TID; SID-->>BID' AS MVD, CASE WHEN COUNT(*) = 0 THEN 'Gildir' ELSE 'Gildir ekki' END AS VALIDITY
FROM(
 SELECT SID
  FROM Courses
 GROUP BY SID
 HAVING COUNT(*) > 1 AND COUNT(*) <> COUNT(DISTINCT CID) * COUNT(DISTINCT TID) * COUNT(DISTINCT BID)
) Y;
